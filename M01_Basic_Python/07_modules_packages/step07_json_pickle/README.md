# M1.7 ‚Äî Modules & Packages
## Step 07 ‚Äî –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (JSON –∏ Pickle)

–í —ç—Ç–æ–º —à–∞–≥–µ –º—ã —Ä–∞—Å—à–∏—Ä—è–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª CLI-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –∏ —É—á–∏–º—Å—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ñ–∞–π–ª—ã —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤.

---

## üìò –¢–µ–æ—Ä–∏—è

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ
–ö–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (RAM). –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –æ–Ω–∏ –∏—Å—á–µ–∑–∞—é—Ç.
–ß—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å—Ç–æ—Ä–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞), –∏—Ö –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤ —Ñ–∞–π–ª.

üëâ –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ Python –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è.

–í Python –µ—Å—Ç—å –¥–≤–∞ –≥–ª–∞–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:
- **JSON** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç;
- **Pickle** ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, ¬´—Ä–æ–¥–Ω–æ–π¬ª –¥–ª—è Python.

---

### JSON

**JSON (JavaScript Object Notation)** ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö ¬´–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ¬ª.
–ü–æ–ø—É–ª—è—Ä–µ–Ω –≤ API, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –∏ –ª–æ–≥–∞—Ö.

–ü—Ä–∏–º–µ—Ä JSON:
```json
[
  {"operation": "add", "operands": [2, 3], "result": 5},
  {"operation": "sub", "operands": [10, 7], "result": 3}
]
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã:**
- `dict` ‚Üí `{}`
- `list`, `tuple` ‚Üí `[]`
- `str` ‚Üí —Å—Ç—Ä–æ–∫–∞
- `int`, `float` ‚Üí —á–∏—Å–ª–æ
- `bool` ‚Üí `true`/`false`
- `None` ‚Üí `null`

**–ú–æ–¥—É–ª—å `json`:**
```python
import json

data = {"operation": "add", "operands": [2, 3], "result": 5}

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
with open("history.json", "w", encoding="utf-8") as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

# –ó–∞–≥—Ä—É–∑–∫–∞
with open("history.json", "r", encoding="utf-8") as f:
    loaded = json.load(f)
```

–í–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `ensure_ascii=False` ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ;
- `indent=2` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ;
- `sort_keys=True` ‚Äî —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–π.

---

### Pickle

**Pickle** ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Python-–æ–±—ä–µ–∫—Ç–æ–≤.
–ì–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ: —É–º–µ–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ—á—Ç–∏ –≤—Å—ë, –≤–∫–ª—é—á–∞—è –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –æ–±—ä–µ–∫—Ç—ã.

**–ú–∏–Ω—É—Å—ã:**
- –§–æ—Ä–º–∞—Ç ¬´–∑–∞–∫—Ä—ã—Ç—ã–π¬ª (—Ç–æ–ª—å–∫–æ Python);
- –ù–µ —á–∏—Ç–∞–µ–º —á–µ–ª–æ–≤–µ–∫–æ–º;
- –ù–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω (–Ω–µ–ª—å–∑—è –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤).

**–ú–æ–¥—É–ª—å `pickle`:**
```python
import pickle

data = {"operation": "mul", "operands": [4, 5], "result": 20}

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
with open("history.pkl", "wb") as f:
    pickle.dump(data, f)

# –ó–∞–≥—Ä—É–∑–∫–∞
with open("history.pkl", "rb") as f:
    loaded = pickle.load(f)

print(loaded)
```

---

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤

| –°–≤–æ–π—Å—Ç–≤–æ       | JSON                 | Pickle                |
|----------------|----------------------|-----------------------|
| –§–æ—Ä–º–∞—Ç         | –¢–µ–∫—Å—Ç–æ–≤—ã–π (UTF-8)    | –ë–∏–Ω–∞—Ä–Ω—ã–π              |
| –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å     | ‚úÖ –ß–∏—Ç–∞–µ–º—ã–π          | ‚ùå –ù–µ—á–∏—Ç–∞–µ–º—ã–π          |
| –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å  | ‚úÖ –ú–µ–∂—ä—è–∑—ã–∫–æ–≤–æ–π      | ‚ùå –¢–æ–ª—å–∫–æ Python       |
| –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö    | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ         | –ü–æ—á—Ç–∏ –ª—é–±—ã–µ           |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å   | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–µ–Ω         | ‚ùå –û–ø–∞—Å–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ |
| –°–∫–æ—Ä–æ—Å—Ç—å       | –°—Ä–µ–¥–Ω—è—è              | –ù–µ–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ       |

üëâ –í—ã–≤–æ–¥:
- –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ ‚Üí **JSON**,
- –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ —Å—É–≥—É–±–æ Python-–æ–±—ä–µ–∫—Ç–æ–≤ ‚Üí **Pickle**.

---

## üõ† –ü—Ä–∞–∫—Ç–∏–∫–∞

–ú—ã –¥–æ–±–∞–≤–∏–ª–∏ –≤ –ø—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏:

- –ø–∞–ø–∫—É `data/` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏;
- —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `storage.py`:
  - `get_data_dir`, `ensure_data_dir`;
  - `get_history_path`, `ensure_history_file`;
  - `load_history_json`, `save_history_json`;
  - `load_history_pickle`, `save_history_pickle`;
  - `load_history`, `save_history` (—É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å).

–§–æ—Ä–º–∞—Ç –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ CLI `--format {json,pickle}`.
–ò—Å—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π:
```python
{
  "operation": "add",
  "operands": [2, 3],
  "result": 5
}
```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–∏–º–µ—Ä—ã

```bash
# –ü–æ–∫–∞–∑ –ø—É—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏ (JSON –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python -m app.main --show-history
# []

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
python -m app.main add 2 3 --show-history
python -m app.main sub 10 7 --show-history

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Pickle
python -m app.main mul 4 5 --format pickle --show-history

# –í–æ–∑–≤—Ä–∞—Ç –≤ JSON (–Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –∏—Å—Ç–æ—Ä–∏—è)
python -m app.main --show-history

# –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
python -m app.main --clear-history --show-history
# []
```

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—à–∞–≥ 7)

```
step07_json_pickle/
‚îú‚îÄ app/
‚îÇ  ‚îú‚îÄ core/
‚îÇ  ‚îÇ  ‚îî‚îÄ operations.py
‚îÇ  ‚îú‚îÄ utils/
‚îÇ  ‚îÇ  ‚îî‚îÄ storage.py
‚îÇ  ‚îî‚îÄ main.py
‚îú‚îÄ data/
‚îÇ  ‚îú‚îÄ history.json
‚îÇ  ‚îî‚îÄ history.pkl
‚îî‚îÄ README.md
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- –û—Å–≤–æ–∏–ª–∏ —Ä–∞–±–æ—Ç—É —Å **—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π** –≤ Python (JSON –∏ Pickle).
- –ù–∞—É—á–∏–ª–∏—Å—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏.
- –†–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ —Ñ–ª–∞–≥–∏ CLI:
  - `--show-history` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é,
  - `--clear-history` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é,
  - `--format` ‚Äî –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è.


## üõü –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫
_(–¥–æ–±–∞–≤–∏—Ç—å —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏)_
