# M2.7 â€” ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ðµ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñ‹ (Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» with)

ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ð¿Ð¾ÑÐ²ÑÑ‰Ñ‘Ð½ **Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾Ð¼Ñƒ Ð¸ Ð¸Ð½Ð¶ÐµÐ½ÐµÑ€Ð½Ð¾Ð¼Ñƒ** Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸ÑŽ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ñ… Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð² Ð² Python. ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ†ÐµÐ»ÑŒ â€” Ð½Ð°ÑƒÑ‡Ð¸Ñ‚ÑŒÑÑ **Ð¾ÑÐ¾Ð·Ð½Ð°Ð½Ð½Ð¾ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼Ð¸ Ð¸ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼**, Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ñ€ÐµÐ°Ð»ÑŒÐ½ÑƒÑŽ Ð¼ÐµÑ…Ð°Ð½Ð¸ÐºÑƒ `with` Ð¸ ÑƒÐ¼ÐµÑ‚ÑŒ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ðµ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñ‹ Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¾Ð¹ Ð¸ ÑÑ‚Ñ€Ð¾Ð³Ð¾Ð¹ Ñ‚Ð¸Ð¿Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹.

---

## ðŸŽ¯ Ð§Ñ‚Ð¾ Ñ‚Ñ‹ Ð¾ÑÐ²Ð¾Ð¸ÑˆÑŒ

- Ð·Ð°Ñ‡ÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ðµ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñ‹ Ð¸ ÐºÐ°ÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð¾Ð½Ð¸ Ñ€ÐµÑˆÐ°ÑŽÑ‚
- ÐºÐ°Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» `with` Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð¸ÑÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
- ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð² `__enter__` Ð¸ `__exit__`
- ÐºÐ°Ðº `with` Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²ÑƒÐµÑ‚ Ñ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸ÑÐ¼Ð¸
- ÐºÐ¾Ð³Ð´Ð° Ð¸ ÐºÐ°Ðº Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ð¾ Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
- Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ñ… Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð²:
  - Ñ‡ÐµÑ€ÐµÐ· ÐºÐ»Ð°ÑÑÑ‹
  - Ñ‡ÐµÑ€ÐµÐ· `contextlib.contextmanager`
- ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼Ð¸ (Ñ„Ð°Ð¹Ð»Ñ‹, Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ)
- ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½ÑƒÑŽ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°
- Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ sentinel-Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²
- ÑÑ‚Ñ€Ð¾Ð³ÑƒÑŽ Ñ‚Ð¸Ð¿Ð¸Ð·Ð°Ñ†Ð¸ÑŽ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ñ… Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð² (mypy strict)

---

## ðŸ“˜ ÐŸÐ¾Ð»Ð½Ð°Ñ Ñ‚ÐµÐ¾Ñ€Ð¸Ñ

### 1. ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð° ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼Ð¸

Ð’Ð¾ Ð¼Ð½Ð¾Ð³Ð¸Ñ… Ð·Ð°Ð´Ð°Ñ‡Ð°Ñ… Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ñ **Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼Ð¸**, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ ÑÑ‚Ñ€Ð¾Ð³Ð¾Ð³Ð¾ Ð¶Ð¸Ð·Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ†Ð¸ÐºÐ»Ð°:

- Ñ„Ð°Ð¹Ð»Ñ‹ (Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ â†’ Ð·Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ)
- Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ (Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð¸Ñ‚ÑŒ â†’ Ð¾ÑÐ²Ð¾Ð±Ð¾Ð´Ð¸Ñ‚ÑŒ)
- ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ (ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ â†’ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ)
- Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸/ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²

ÐšÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°:

> Ñ€ÐµÑÑƒÑ€Ñ **Ð¾Ð±ÑÐ·Ð°Ð½ Ð±Ñ‹Ñ‚ÑŒ Ð¾ÑÐ²Ð¾Ð±Ð¾Ð¶Ð´Ñ‘Ð½**, Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ð´Ð° Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð¾ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ.

Ð‘ÐµÐ· ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ð¾Ð³Ð¾ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð° Ð»ÐµÐ³ÐºÐ¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑƒÑ‚ÐµÑ‡ÐºÐ¸ Ð¸ Ð½ÐµÐºÐ¾Ð½ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð±ÐµÐ· `with`:**

```python
f = open("data/text.txt", "w")
try:
    f.write("Hello")
finally:
    f.close()
```

Ð­Ñ‚Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚, Ð½Ð¾ ÑˆÐ°Ð±Ð»Ð¾Ð½ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ ÑÐ½Ð¾Ð²Ð° Ð¸ ÑÐ½Ð¾Ð²Ð°.

---

### 2. `with` ÐºÐ°Ðº Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚

`with` ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ ÑÑ‚Ð¾Ñ‚ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½ Ð¸ Ð´ÐµÐ»Ð°ÐµÑ‚ ÐµÐ³Ð¾ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ñ‹Ð¼:

```python
with open("data/text.txt", "w") as f:
    f.write("Hello")
```

Ð˜Ð´ÐµÑ: **Ð²Ñ…Ð¾Ð´** Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ â†’ Ñ€Ð°Ð±Ð¾Ñ‚Ð° â†’ **Ð²Ñ‹Ñ…Ð¾Ð´** Ð¸ Ð¾ÑÐ²Ð¾Ð±Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÐ°.

---

### 3. ÐŸÑ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» `with`

ÐžÐ±ÑŠÐµÐºÑ‚ ÑÐ²Ð»ÑÐµÑ‚ÑÑ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¼ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼, ÐµÑÐ»Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ Ð´Ð²Ð° Ð¼ÐµÑ‚Ð¾Ð´Ð°:

- `__enter__(self)`
- `__exit__(self, exc_type, exc_val, exc_tb)`

ÐŸÐ¾Ñ‡Ñ‚Ð¸ Ñ‚Ð¾Ñ‡Ð½Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ `with` (ÑƒÐ¿Ñ€Ð¾Ñ‰Ñ‘Ð½Ð½Ð¾):

```python
mgr = EXPR
value = mgr.__enter__()
try:
    BODY
except BaseException as e:
    suppress = mgr.__exit__(type(e), e, e.__traceback__)
    if not suppress:
        raise
else:
    mgr.__exit__(None, None, None)
```

Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ:
- `__exit__` Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ **Ð²ÑÐµÐ³Ð´Ð°**
- `__exit__` Ð¼Ð¾Ð¶ÐµÑ‚ **Ð¿Ð¾Ð´Ð°Ð²Ð¸Ñ‚ÑŒ** Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ (ÐµÑÐ»Ð¸ Ð²ÐµÑ€Ð½Ñ‘Ñ‚ `True`)

---

### 4. `__enter__`: Ñ‡Ñ‚Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ Ð¸ Ð·Ð°Ñ‡ÐµÐ¼

`__enter__` Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð¸ **Ð¼Ð¾Ð¶ÐµÑ‚ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð¾Ð±ÑŠÐµÐºÑ‚**, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð² `as`.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ (Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ñ€ÐµÑÑƒÑ€Ñ):**

```python
with FileOpener("data/text.txt", "w") as f:
    f.write("Hello")
```

Ð—Ð´ÐµÑÑŒ `FileOpener.__enter__` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ñ„Ð°Ð¹Ð»Ð¾Ð²Ñ‹Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚ `f`.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ (Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ `self`):**

```python
with Timer() as t:
    heavy_work()
# t ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¸Ð·Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ
```

---

### 5. `__exit__`: Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¸ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸

`__exit__` Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾Ð± Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¸:

- `exc_type`: Ñ‚Ð¸Ð¿ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¸Ð»Ð¸ `None`
- `exc_val`: Ð¾Ð±ÑŠÐµÐºÑ‚ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¸Ð»Ð¸ `None`
- `exc_tb`: traceback Ð¸Ð»Ð¸ `None`

Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ `__exit__`:

- `True` â†’ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ **Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÐµÑ‚ÑÑ**
- `False`/`None` â†’ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ **Ð¿Ñ€Ð¾Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ÑÑ** Ð´Ð°Ð»ÑŒÑˆÐµ

**ÐŸÑ€Ð¸Ð¼ÐµÑ€: Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð½Ðµ Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÐµÐ¼ (ÐºÐ°Ðº Ð² Task 03):**

```python
with FileOpener("data/text.txt", "w") as f:
    f.write("Hello")
    1 / 0  # Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð²Ñ‹Ð»ÐµÑ‚Ð¸Ñ‚ Ð½Ð°Ñ€ÑƒÐ¶Ñƒ
```

ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð²ÑÑ‘ Ñ€Ð°Ð²Ð½Ð¾ Ð·Ð°ÐºÑ€Ð¾ÐµÑ‚ Ñ„Ð°Ð¹Ð».

---

### 6. ÐŸÐ¾Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹

Ð˜Ð½Ð¾Ð³Ð´Ð° Ð½ÑƒÐ¶Ð½Ð¾ Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÑ‚ÑŒ **Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼ÑƒÑŽ** Ð¾ÑˆÐ¸Ð±ÐºÑƒ.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€: Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ `ValueError`:**

```python
with SuppressError(ValueError):
    int("abc")  # ValueError Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð´Ð°Ð²Ð»ÐµÐ½

with SuppressError(ValueError):
    1 / 0        # ZeroDivisionError ÐÐ• Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð´Ð°Ð²Ð»ÐµÐ½
```

ÐŸÑ€Ð°Ð²Ð¸Ð»Ð¾ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸:

> Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾ÑˆÐ¸Ð±ÐºÐ¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ñ‚Ñ‹ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ð¶Ð¸Ð´Ð°ÐµÑˆÑŒ Ð¸ ÑƒÐ¼ÐµÐµÑˆÑŒ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ.

---

### 7. ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ðµ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñ‹ ÐºÐ°Ðº ÐºÐ»Ð°ÑÑÑ‹

ÐšÐ»Ð°ÑÑÑ‹ ÑƒÐ´Ð¾Ð±Ð½Ñ‹, ÐºÐ¾Ð³Ð´Ð°:

- Ð½ÑƒÐ¶Ð½Ð¾ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
- Ð½ÑƒÐ¶Ð½Ð° ÑÑ‚Ñ€Ð¾Ð³Ð°Ñ Ñ‚Ð¸Ð¿Ð¸Ð·Ð°Ñ†Ð¸Ñ
- Ð»Ð¾Ð³Ð¸ÐºÐ° Ð½Ðµ Ð¿Ð¾Ð¼ÐµÑ‰Ð°ÐµÑ‚ÑÑ Ð² Â«Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑÑ‚Ñ€Ð¾ÐºÂ»

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ (Ñ‚Ð°Ð¹Ð¼ÐµÑ€, Task 01):**

```python
with Timer():
    for _ in range(1_000_000):
        pass
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ (Ñ„Ð°Ð¹Ð», Task 03):**

```python
with FileOpener("data/text.txt", "w") as f:
    f.write("Hello World")
```

---

### 8. `contextlib.contextmanager`

Ð•ÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð¿Ð°ÐºÑ‚Ð½Ð°Ñ Ñ„Ð¾Ñ€Ð¼Ð° Ñ‡ÐµÑ€ÐµÐ· Ð³ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€:

- ÐºÐ¾Ð´ Ð´Ð¾ `yield` â†’ Ð²Ñ…Ð¾Ð´ (Ð°Ð½Ð°Ð»Ð¾Ð³ `__enter__`)
- ÐºÐ¾Ð´ Ð¿Ð¾ÑÐ»Ðµ `yield` â†’ Ð²Ñ‹Ñ…Ð¾Ð´ (Ð°Ð½Ð°Ð»Ð¾Ð³ `__exit__`)
- `finally` Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ñ‚ÐºÐ°Ñ‚ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ (TempAttribute Ñ‡ÐµÑ€ÐµÐ· `@contextmanager`):**

```python
with temp_attribute(obj, "debug", True):
    ...
```

---

### 9. Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ

Ð¢Ð¸Ð¿Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐµÐ¹Ñ â€” Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð¿Ð¾Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚, Ð° Ð·Ð°Ñ‚ÐµÐ¼ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€: Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð»:**

```python
obj.debug = False
with TempAttribute(obj, "debug", True):
    assert obj.debug is True
assert obj.debug is False
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€: Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ð° Ð½Ðµ Ð±Ñ‹Ð»Ð¾:**

```python
assert not hasattr(obj, "debug")
with TempAttribute(obj, "debug", True):
    assert obj.debug is True
assert not hasattr(obj, "debug")
```

---

### 10. Sentinel-Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹

ÐÐµÐ»ÑŒÐ·Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ `None` ÐºÐ°Ðº Ð¼Ð°Ñ€ÐºÐµÑ€ Â«Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ð° Ð½Ðµ Ð±Ñ‹Ð»Ð¾Â», Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ `None` Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÐµÐ¼.

Ð ÐµÑˆÐµÐ½Ð¸Ðµ â€” ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¼Ð°Ñ€ÐºÐµÑ€:

```python
_MISSING = object()
```

Ð˜ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· `is`:

- `old_value is _MISSING` â†’ Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ð° Ð½Ðµ Ð±Ñ‹Ð»Ð¾
- Ð¸Ð½Ð°Ñ‡Ðµ â†’ Ð±Ñ‹Ð»Ð¾ ÑÑ‚Ð°Ñ€Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ (Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ `None`)

---

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¼Ð¾Ð´ÑƒÐ»Ñ

```text
07_context_managers/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ .gitkeep
â”‚   â””â”€â”€ text.txt
â”œâ”€â”€ task01_simple_timer.py
â”œâ”€â”€ task02_suppress_error.py
â”œâ”€â”€ task03_file_opener.py
â”œâ”€â”€ task04_temp_attribute.py
â”œâ”€â”€ task05_temp_attribute_contextlib.py
â””â”€â”€ README.md
```

---

## ðŸ§© Ð—Ð°Ð´Ð°Ð½Ð¸Ñ

### Task 01 â€” SimpleTimer
Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð´Ð»Ñ Ð¸Ð·Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð±Ð»Ð¾ÐºÐ° ÐºÐ¾Ð´Ð°.

### Task 02 â€” SuppressError
ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð´Ð»Ñ Ð¾ÑÐ¾Ð·Ð½Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð° Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ.

### Task 03 â€” FileOpener
ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð´Ð»Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ñ„Ð°Ð¹Ð»Ð°Ð¼Ð¸.

### Task 04 â€” TempAttribute
ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð´Ð»Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ð° Ð¾Ð±ÑŠÐµÐºÑ‚Ð° Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¼ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ.

### Task 05 â€” TempAttribute (`contextlib`)
ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ñ‡ÐµÑ€ÐµÐ· `@contextmanager`.

---

## â–¶ï¸ ÐšÐ°Ðº Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ

Ð—Ð°Ð¿ÑƒÑÐº Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ð½Ð¸Ð¹:

```bash
python taskXX_*.py
```

ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¸Ð¿Ð¸Ð·Ð°Ñ†Ð¸Ð¸:

```bash
mypy taskXX_*.py
```

---

## âœ… ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸

ÐœÐ¾Ð´ÑƒÐ»ÑŒ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ð·Ð°Ð²ÐµÑ€ÑˆÑ‘Ð½Ð½Ñ‹Ð¼, ÐµÑÐ»Ð¸:

- Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹ Ð²ÑÐµ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ
- Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð²ÑÐµÐ³Ð´Ð° ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽÑ‚ÑÑ
- Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð½Ðµ Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÑŽÑ‚ÑÑ Ð±ÐµÐ· ÑÐ²Ð½Ð¾Ð³Ð¾ Ð½Ð°Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ
- ÐºÐ¾Ð´ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ ÑÑ‚Ñ€Ð¾Ð³ÑƒÑŽ Ñ‚Ð¸Ð¿Ð¸Ð·Ð°Ñ†Ð¸ÑŽ (`mypy strict`)
- Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ `Any`

---

## ðŸ›Ÿ Ð£ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ð¾Ðº

**`__exit__` Ð²ÐµÐ´Ñ‘Ñ‚ ÑÐµÐ±Ñ ÑÑ‚Ñ€Ð°Ð½Ð½Ð¾:**
- Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ
- `True` Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÐµÑ‚ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ

**ÐÑ‚Ñ€Ð¸Ð±ÑƒÑ‚ Ð½Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð»ÑÑ:**
- Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒ Ð»Ð¾Ð³Ð¸ÐºÑƒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Â«Ð±Ñ‹Ð» / Ð½Ðµ Ð±Ñ‹Ð»Â»
- Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ sentinel-Ð¾Ð±ÑŠÐµÐºÑ‚

**`mypy` Ñ€ÑƒÐ³Ð°ÐµÑ‚ÑÑ:**
- Ð°Ð½Ð½Ð¾Ñ‚Ð°Ñ†Ð¸Ñ `__exit__` Ð´Ð¾Ð»Ð¶Ð½Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼Ñƒ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸ÑŽ
- ÐµÑÐ»Ð¸ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð½Ðµ Ð¿Ð¾Ð´Ð°Ð²Ð»ÑÑŽÑ‚ÑÑ â†’ `-> None`
